# 🎰 Slot Master Pro (スロット攻略 Pro)

「みんレポ」のデータを収集・データベース化し、ホールの傾向を爆速で分析するためのツールです。
Python + Streamlit + SQLite で動作し、数年分のデータも一瞬で表示・分析可能です。

## ✨ 主な機能

### 1. 爆速データベース・アーキテクチャ
* **SQLite採用**: 従来のCSVファイル管理からSQLiteデータベース(`slot_data.db`)へ移行。数万件のデータも一瞬で読み込みます。
* **自動マイグレーション**: 過去のCSVデータも `migrate.py` で一括してデータベースに格納可能。

### 2. 鉄壁のデータ収集 (スクレイピング)
* **時間制限ガード**: ダミーデータを掴まされないよう、データの信頼性が高い **8:00〜9:59** の間だけ収集ボタンが有効になります。
* **ダミーデータ撃退機能**: 万が一時間外にアクセスしても、データの中身を検証（マイナス差枚がない不自然なデータを検知）し、保存を自動で回避します。
* **Cloudflare対策**: `curl_cffi` や `fake_useragent` を用いた高度な偽装リクエストで、アクセスブロックを回避します。

### 3. 高度な分析機能
* **📅 日別レポート**: 
  * 1ページ約2ヶ月分のカレンダー形式で見やすく表示。
  * **「強末尾」判定**: 勝率50%以上・平均差枚プラスの末尾番号を自動検出。
  * **アイコン判定**: ★(鉄板)、◎(絶好調)、🌀(ぶん回し) など、優秀台をアイコンで可視化。
* **🔥 機種別分析**: 
  * バブルチャートで「勝率 vs 平均差枚」を可視化。店長が力を入れている機種が一目でわかります。
* **🔍 鉄板台サーチ & 🍇ブドウ逆算**: 
  * 回転数や差枚数でフィルタリングし、ジャグラーシリーズの **「推定ブドウ確率」** を逆算して表示。
* **🕵️‍♀️ 不発・塊検知**: 
  * 「REGは引けているのに負けている台（不発）」や「並びで出ている箇所（塊）」を自動抽出。

### 4. AI連携
* **AI用CSV出力**: ボタン一つで、ChatGPTやClaudeでの分析に最適化されたCSVファイルをダウンロード可能。AIに明日の狙い目を相談できます。

---

## 🛠 インストール & セットアップ

### 必要ライブラリ
以下のコマンドで必要なライブラリをインストールしてください。

```bash
pip install streamlit pandas plotly beautifulsoup4 requests fake-useragent curl_cffi


ファイル構成
app.py: アプリ本体（UI・表示ロジック）。

logic.py: スクレイピング処理・DB保存・設定読み込みなどの裏方処理。

migrate.py: 過去のCSVファイルをデータベースに移行するスクリプト。

stores.txt: 店舗リスト設定ファイル。

🚀 使い方
1. 店舗の設定 (stores.txt)
stores.txt に分析したい店舗を記述します。 形式: 店舗名 | みんレポのURL | イベント情報メモ

Plaintext

三ノ輪UNO | [https://min-repo.com/tag/三ノ輪uno/](https://min-repo.com/tag/三ノ輪uno/) | 旧イベ: 1のつく日
アイランド秋葉原 | [https://min-repo.com/tag/アイランド秋葉原店/](https://min-repo.com/tag/アイランド秋葉原店/) | 旧イベ: 6のつく日
※ URLは必ず /tag/〇〇/ の形式（一覧ページ）を指定してください。

2. アプリの起動
ターミナルで以下のコマンドを実行します。

Bash

streamlit run app.py
ブラウザが立ち上がり、分析画面が表示されます。

3. データの収集
朝 8:00 〜 9:59 の間にアプリを開きます。

サイドバーの「データの更新・収集」を開きます。

「✅ 収集中可能」となっていることを確認し、「データ収集開始」ボタンを押します。

収集が完了すると、自動的にデータベースに保存され、画面に反映されます。

4. 過去データの移行 (初回のみ)
手持ちのCSVファイルがある場合、以下のコマンドでデータベースに取り込めます。

Bash

python migrate.py
⚠️ 注意事項
収集時間について: サイト側の仕様により、深夜〜早朝は不正確なデータ（マイナス差枚の隠蔽など）が表示されることがあります。そのため、本ツールは 8:00〜9:59 以外は収集機能をロックしています。

ご利用は自己責任で: 本ツールは個人利用を目的としています。過度なアクセスは控え、サーバーに負荷をかけないように配慮してください。